{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 0.0}, "policy_reward_mean": {"ppo": 0.0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 3.0, "shaped_reward_min": 3, "shaped_reward_max": 3, "off_dist_sparse_reward_mean": 0.0, "off_dist_sparse_reward_min": 0, "off_dist_sparse_reward_max": 0, "off_dist_shaped_reward_mean": 0.0, "off_dist_shaped_reward_min": 0, "off_dist_shaped_reward_max": 0, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.5, "onion_pickup_agent_0_min": 3, "onion_pickup_agent_0_max": 4, "onion_pickup_agent_1_mean": 6.5, "onion_pickup_agent_1_min": 5, "onion_pickup_agent_1_max": 8, "useful_onion_pickup_agent_0_mean": 2.0, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 3, "useful_onion_pickup_agent_1_mean": 5.0, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 8, "onion_drop_agent_0_mean": 2.0, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 3, "onion_drop_agent_1_mean": 5.5, "onion_drop_agent_1_min": 4, "onion_drop_agent_1_max": 7, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 1, "useful_onion_drop_agent_1_mean": 2.0, "useful_onion_drop_agent_1_min": 1, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 0.5, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 0.5, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 1, "dish_pickup_agent_0_mean": 3.5, "dish_pickup_agent_0_min": 3, "dish_pickup_agent_0_max": 4, "dish_pickup_agent_1_mean": 0.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 1, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 3.5, "dish_drop_agent_0_min": 3, "dish_drop_agent_0_max": 4, "dish_drop_agent_1_mean": 0.0, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 0, "useful_dish_drop_agent_0_mean": 2.0, "useful_dish_drop_agent_0_min": 1, "useful_dish_drop_agent_0_max": 3, "useful_dish_drop_agent_1_mean": 0.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 0, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.5, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 0.5, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 1, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.5, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 0.5, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 1, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0, "is_off_distribution_agent_0_mean": 0.0, "is_off_distribution_agent_0_min": 0, "is_off_distribution_agent_0_max": 0, "is_off_distribution_agent_1_mean": 0.0, "is_off_distribution_agent_1_min": 0, "is_off_distribution_agent_1_max": 0, "reward_shaping_factor_mean": 0.0, "reward_shaping_factor_min": 0.0, "reward_shaping_factor_max": 0.0, "potential_shaping_factor_mean": 0.0, "potential_shaping_factor_min": 0.0, "potential_shaping_factor_max": 0.0, "bc_factor_mean": 0.0, "bc_factor_min": 0.0, "bc_factor_max": 0.0}, "hist_stats": {"episode_reward": [0.0, 0.0], "episode_lengths": [400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.08791699968371308, "mean_inference_ms": 0.8788501235315034, "mean_action_processing_ms": 0.053995862566027564, "mean_env_wait_ms": 0.6023291637772634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 800, "agent_timesteps_total": 1600, "timers": {"sample_time_ms": 671.364, "sample_throughput": 1191.604, "learn_time_ms": 386.154, "learn_throughput": 2071.713, "update_time_ms": 2.39}, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": -6.195041351020336e-05, "policy_loss": -6.224121898412704e-05, "vf_loss": 0.0017343811923637986, "vf_explained_var": -1.0, "kl": 5.933894158260955e-07, "entropy": 1.791083574295044, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 800, "num_agent_steps_sampled": 1600, "num_steps_trained": 800, "num_agent_steps_trained": 1600}, "done": false, "episodes_total": 2, "training_iteration": 1, "experiment_id": "3acdca3ad0124e18ad2942cc85603152", "date": "2021-06-10_12-08-16", "timestamp": 1623352096, "time_this_iter_s": 1.161289930343628, "time_total_s": 1.161289930343628, "pid": 92057, "hostname": "Nathans-MacBook-Pro.local", "node_ip": "192.168.1.27", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "train_batch_size": 800, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_schedule": [[0, 1.0], [3000000.0, 0]], "potential_shaping_schedule": [[0, 1.0], [Infinity, 0]], "use_potential_shaping": false, "use_reward_shaping": false, "bc_schedule": [[0, 0], [Infinity, 0]], "potential_constants": {"min_coeff": 0.7, "max_delivery_steps": 10, "max_pickup_steps": 20, "pot_onion_steps": 10, "pot_tomato_steps": 10, "useful_counter_coeff": 2, "non_useful_counter_coeff": 0}, "bc_opt": false, "ficticious_self_play": false}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "log_level": "ERROR", "callbacks": "<function gen_trainer_from_params.<locals>.<lambda> at 0x7ff7c4756680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 10, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7ff7c445da70>", "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ppo": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(0.0, inf, (5, 4, 26), float32)", "Discrete(6)", {"model": {"custom_model_config": {"use_lstm": false, "vf_share_layers": true, "NUM_HIDDEN_LAYERS": 3, "SIZE_HIDDEN_LAYERS": 64, "NUM_FILTERS": 25, "NUM_CONV_LAYERS": 3, "CELL_SIZE": 256, "D2RL": false}, "custom_model": "MyPPOModel"}}]}, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7ff7c4756ef0>", "policies_to_train": ["ppo"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.98, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "shuffle_sequences": true, "num_sgd_iter": 1, "lr_schedule": null, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1.161289930343628, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.6, "ram_util_percent": 62.8}}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 0.0}, "policy_reward_mean": {"ppo": 0.0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.25, "shaped_reward_min": 3, "shaped_reward_max": 9, "off_dist_sparse_reward_mean": 0.0, "off_dist_sparse_reward_min": 0, "off_dist_sparse_reward_max": 0, "off_dist_shaped_reward_mean": 0.0, "off_dist_shaped_reward_min": 0, "off_dist_shaped_reward_max": 0, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.5, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 5, "onion_pickup_agent_1_mean": 4.5, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 8, "useful_onion_pickup_agent_0_mean": 2.0, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 3, "useful_onion_pickup_agent_1_mean": 3.75, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 8, "onion_drop_agent_0_mean": 2.25, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 4, "onion_drop_agent_1_mean": 3.0, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 7, "useful_onion_drop_agent_0_mean": 0.75, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 1.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 0.5, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 3.5, "dish_pickup_agent_0_min": 3, "dish_pickup_agent_0_max": 4, "dish_pickup_agent_1_mean": 2.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.25, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 3.5, "dish_drop_agent_0_min": 3, "dish_drop_agent_0_max": 4, "dish_drop_agent_1_mean": 2.0, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.75, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 3, "useful_dish_drop_agent_1_mean": 1.5, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 6, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.5, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.5, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0, "is_off_distribution_agent_0_mean": 0.0, "is_off_distribution_agent_0_min": 0, "is_off_distribution_agent_0_max": 0, "is_off_distribution_agent_1_mean": 0.0, "is_off_distribution_agent_1_min": 0, "is_off_distribution_agent_1_max": 0, "reward_shaping_factor_mean": 0.0, "reward_shaping_factor_min": 0.0, "reward_shaping_factor_max": 0.0, "potential_shaping_factor_mean": 0.0, "potential_shaping_factor_min": 0.0, "potential_shaping_factor_max": 0.0, "bc_factor_mean": 0.0, "bc_factor_min": 0.0, "bc_factor_max": 0.0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.08767073064805248, "mean_inference_ms": 0.8468516809680595, "mean_action_processing_ms": 0.05476647770771758, "mean_env_wait_ms": 0.6053416690842864, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1600, "agent_timesteps_total": 3200, "timers": {"sample_time_ms": 651.359, "sample_throughput": 1228.201, "learn_time_ms": 238.402, "learn_throughput": 3355.683, "update_time_ms": 2.302}, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": -3.3676624298095703e-06, "policy_loss": -3.5017728805541992e-06, "vf_loss": 0.0012875297106802464, "vf_explained_var": -1.0, "kl": 1.1483410844448372e-07, "entropy": 1.7912181615829468, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1600, "num_agent_steps_sampled": 3200, "num_steps_trained": 1600, "num_agent_steps_trained": 3200}, "done": false, "episodes_total": 4, "training_iteration": 2, "experiment_id": "3acdca3ad0124e18ad2942cc85603152", "date": "2021-06-10_12-08-17", "timestamp": 1623352097, "time_this_iter_s": 0.8002686500549316, "time_total_s": 1.9615585803985596, "pid": 92057, "hostname": "Nathans-MacBook-Pro.local", "node_ip": "192.168.1.27", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "train_batch_size": 800, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_schedule": [[0, 1.0], [3000000.0, 0]], "potential_shaping_schedule": [[0, 1.0], [Infinity, 0]], "use_potential_shaping": false, "use_reward_shaping": false, "bc_schedule": [[0, 0], [Infinity, 0]], "potential_constants": {"min_coeff": 0.7, "max_delivery_steps": 10, "max_pickup_steps": 20, "pot_onion_steps": 10, "pot_tomato_steps": 10, "useful_counter_coeff": 2, "non_useful_counter_coeff": 0}, "bc_opt": false, "ficticious_self_play": false}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "log_level": "ERROR", "callbacks": "<function gen_trainer_from_params.<locals>.<lambda> at 0x7ff7c4756680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 10, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7ff7c445da70>", "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ppo": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(0.0, inf, (5, 4, 26), float32)", "Discrete(6)", {"model": {"custom_model_config": {"use_lstm": false, "vf_share_layers": true, "NUM_HIDDEN_LAYERS": 3, "SIZE_HIDDEN_LAYERS": 64, "NUM_FILTERS": 25, "NUM_CONV_LAYERS": 3, "CELL_SIZE": 256, "D2RL": false}, "custom_model": "MyPPOModel"}}]}, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7ff7c4756ef0>", "policies_to_train": ["ppo"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.98, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "shuffle_sequences": true, "num_sgd_iter": 1, "lr_schedule": null, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1.9615585803985596, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.1, "ram_util_percent": 62.7}}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 0.0}, "policy_reward_mean": {"ppo": 0.0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.0, "shaped_reward_min": 3, "shaped_reward_max": 9, "off_dist_sparse_reward_mean": 0.0, "off_dist_sparse_reward_min": 0, "off_dist_sparse_reward_max": 0, "off_dist_shaped_reward_mean": 0.0, "off_dist_shaped_reward_min": 0, "off_dist_shaped_reward_max": 0, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.3333333333333335, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 5, "onion_pickup_agent_1_mean": 4.333333333333333, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 8, "useful_onion_pickup_agent_0_mean": 2.3333333333333335, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 3, "useful_onion_pickup_agent_1_mean": 3.6666666666666665, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 8, "onion_drop_agent_0_mean": 2.1666666666666665, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 4, "onion_drop_agent_1_mean": 3.0, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 7, "useful_onion_drop_agent_0_mean": 0.6666666666666666, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.6666666666666666, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 0.6666666666666666, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 0.8333333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 3.5, "dish_pickup_agent_0_min": 2, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 3.3333333333333335, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 3.3333333333333335, "dish_drop_agent_0_min": 2, "dish_drop_agent_0_max": 4, "dish_drop_agent_1_mean": 2.8333333333333335, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 2.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 4, "useful_dish_drop_agent_1_mean": 1.5, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 6, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.6666666666666666, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 0.8333333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.6666666666666666, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 0.8333333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0, "is_off_distribution_agent_0_mean": 0.0, "is_off_distribution_agent_0_min": 0, "is_off_distribution_agent_0_max": 0, "is_off_distribution_agent_1_mean": 0.0, "is_off_distribution_agent_1_min": 0, "is_off_distribution_agent_1_max": 0, "reward_shaping_factor_mean": 0.0, "reward_shaping_factor_min": 0.0, "reward_shaping_factor_max": 0.0, "potential_shaping_factor_mean": 0.0, "potential_shaping_factor_min": 0.0, "potential_shaping_factor_max": 0.0, "bc_factor_mean": 0.0, "bc_factor_min": 0.0, "bc_factor_max": 0.0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.08848442068958877, "mean_inference_ms": 0.8454541877958013, "mean_action_processing_ms": 0.05650678014146255, "mean_env_wait_ms": 0.6177178717959547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 2400, "agent_timesteps_total": 4800, "timers": {"sample_time_ms": 673.356, "sample_throughput": 1188.078, "learn_time_ms": 188.387, "learn_throughput": 4246.57, "update_time_ms": 2.229}, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 1.162051921710372e-05, "policy_loss": 1.1491822078824043e-05, "vf_loss": 0.0012211205903440714, "vf_explained_var": -1.0, "kl": 2.1693149676593748e-07, "entropy": 1.7911763191223145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2400, "num_agent_steps_sampled": 4800, "num_steps_trained": 2400, "num_agent_steps_trained": 4800}, "done": false, "episodes_total": 6, "training_iteration": 3, "experiment_id": "3acdca3ad0124e18ad2942cc85603152", "date": "2021-06-10_12-08-18", "timestamp": 1623352098, "time_this_iter_s": 0.8766920566558838, "time_total_s": 2.8382506370544434, "pid": 92057, "hostname": "Nathans-MacBook-Pro.local", "node_ip": "192.168.1.27", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "train_batch_size": 800, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_schedule": [[0, 1.0], [3000000.0, 0]], "potential_shaping_schedule": [[0, 1.0], [Infinity, 0]], "use_potential_shaping": false, "use_reward_shaping": false, "bc_schedule": [[0, 0], [Infinity, 0]], "potential_constants": {"min_coeff": 0.7, "max_delivery_steps": 10, "max_pickup_steps": 20, "pot_onion_steps": 10, "pot_tomato_steps": 10, "useful_counter_coeff": 2, "non_useful_counter_coeff": 0}, "bc_opt": false, "ficticious_self_play": false}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "log_level": "ERROR", "callbacks": "<function gen_trainer_from_params.<locals>.<lambda> at 0x7ff7c4756680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 10, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7ff7c445da70>", "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ppo": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(0.0, inf, (5, 4, 26), float32)", "Discrete(6)", {"model": {"custom_model_config": {"use_lstm": false, "vf_share_layers": true, "NUM_HIDDEN_LAYERS": 3, "SIZE_HIDDEN_LAYERS": 64, "NUM_FILTERS": 25, "NUM_CONV_LAYERS": 3, "CELL_SIZE": 256, "D2RL": false}, "custom_model": "MyPPOModel"}}]}, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7ff7c4756ef0>", "policies_to_train": ["ppo"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.98, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "shuffle_sequences": true, "num_sgd_iter": 1, "lr_schedule": null, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2.8382506370544434, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.05, "ram_util_percent": 62.75}}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 0.0}, "policy_reward_mean": {"ppo": 0.0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.5, "shaped_reward_min": 0, "shaped_reward_max": 14, "off_dist_sparse_reward_mean": 0.0, "off_dist_sparse_reward_min": 0, "off_dist_sparse_reward_max": 0, "off_dist_shaped_reward_mean": 0.0, "off_dist_shaped_reward_min": 0, "off_dist_shaped_reward_max": 0, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.625, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 5, "onion_pickup_agent_1_mean": 3.625, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 8, "useful_onion_pickup_agent_0_mean": 2.875, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 3.125, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 8, "onion_drop_agent_0_mean": 2.375, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 4, "onion_drop_agent_1_mean": 2.375, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 7, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.5, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 0.75, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 2, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 3.625, "dish_pickup_agent_0_min": 2, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 3.0, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.125, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 3.375, "dish_drop_agent_0_min": 2, "dish_drop_agent_0_max": 4, "dish_drop_agent_1_mean": 2.5, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 1.875, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 4, "useful_dish_drop_agent_1_mean": 1.5, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 6, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.125, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.75, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 2, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.75, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 2, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0, "is_off_distribution_agent_0_mean": 0.0, "is_off_distribution_agent_0_min": 0, "is_off_distribution_agent_0_max": 0, "is_off_distribution_agent_1_mean": 0.0, "is_off_distribution_agent_1_min": 0, "is_off_distribution_agent_1_max": 0, "reward_shaping_factor_mean": 0.0, "reward_shaping_factor_min": 0.0, "reward_shaping_factor_max": 0.0, "potential_shaping_factor_mean": 0.0, "potential_shaping_factor_min": 0.0, "potential_shaping_factor_max": 0.0, "bc_factor_mean": 0.0, "bc_factor_min": 0.0, "bc_factor_max": 0.0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.08903342652707408, "mean_inference_ms": 0.8450769174758206, "mean_action_processing_ms": 0.05765827080815218, "mean_env_wait_ms": 0.6246689661616494, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 3200, "agent_timesteps_total": 6400, "timers": {"sample_time_ms": 677.797, "sample_throughput": 1180.294, "learn_time_ms": 163.334, "learn_throughput": 4897.933, "update_time_ms": 2.253}, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 3.609759733080864e-05, "policy_loss": 3.5958364605903625e-05, "vf_loss": 0.0014569619670510292, "vf_explained_var": -1.0, "kl": 6.924673812136461e-08, "entropy": 1.7911170721054077, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 3200, "num_agent_steps_sampled": 6400, "num_steps_trained": 3200, "num_agent_steps_trained": 6400}, "done": false, "episodes_total": 8, "training_iteration": 4, "experiment_id": "3acdca3ad0124e18ad2942cc85603152", "date": "2021-06-10_12-08-19", "timestamp": 1623352099, "time_this_iter_s": 0.8529658317565918, "time_total_s": 3.691216468811035, "pid": 92057, "hostname": "Nathans-MacBook-Pro.local", "node_ip": "192.168.1.27", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "train_batch_size": 800, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_schedule": [[0, 1.0], [3000000.0, 0]], "potential_shaping_schedule": [[0, 1.0], [Infinity, 0]], "use_potential_shaping": false, "use_reward_shaping": false, "bc_schedule": [[0, 0], [Infinity, 0]], "potential_constants": {"min_coeff": 0.7, "max_delivery_steps": 10, "max_pickup_steps": 20, "pot_onion_steps": 10, "pot_tomato_steps": 10, "useful_counter_coeff": 2, "non_useful_counter_coeff": 0}, "bc_opt": false, "ficticious_self_play": false}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "log_level": "ERROR", "callbacks": "<function gen_trainer_from_params.<locals>.<lambda> at 0x7ff7c4756680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 10, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7ff7c445da70>", "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ppo": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(0.0, inf, (5, 4, 26), float32)", "Discrete(6)", {"model": {"custom_model_config": {"use_lstm": false, "vf_share_layers": true, "NUM_HIDDEN_LAYERS": 3, "SIZE_HIDDEN_LAYERS": 64, "NUM_FILTERS": 25, "NUM_CONV_LAYERS": 3, "CELL_SIZE": 256, "D2RL": false}, "custom_model": "MyPPOModel"}}]}, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7ff7c4756ef0>", "policies_to_train": ["ppo"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.98, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "shuffle_sequences": true, "num_sgd_iter": 1, "lr_schedule": null, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3.691216468811035, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.6, "ram_util_percent": 62.7}}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 0.0}, "policy_reward_mean": {"ppo": 0.0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 5.6, "shaped_reward_min": 0, "shaped_reward_max": 14, "off_dist_sparse_reward_mean": 0.0, "off_dist_sparse_reward_min": 0, "off_dist_sparse_reward_max": 0, "off_dist_shaped_reward_mean": 0.0, "off_dist_shaped_reward_min": 0, "off_dist_shaped_reward_max": 0, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.0, "onion_pickup_agent_0_min": 2, "onion_pickup_agent_0_max": 6, "onion_pickup_agent_1_mean": 4.1, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 9, "useful_onion_pickup_agent_0_mean": 3.0, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 5, "useful_onion_pickup_agent_1_mean": 2.8, "useful_onion_pickup_agent_1_min": 0, "useful_onion_pickup_agent_1_max": 8, "onion_drop_agent_0_mean": 2.7, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 5, "onion_drop_agent_1_mean": 3.0, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 8, "useful_onion_drop_agent_0_mean": 0.9, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 5, "useful_onion_drop_agent_1_mean": 1.2, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 8, "potting_onion_agent_0_mean": 0.8, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 2, "potting_onion_agent_1_mean": 0.6, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 2, "dish_pickup_agent_0_mean": 3.8, "dish_pickup_agent_0_min": 2, "dish_pickup_agent_0_max": 5, "dish_pickup_agent_1_mean": 2.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 9, "useful_dish_pickup_agent_0_mean": 0.3, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 3.5, "dish_drop_agent_0_min": 2, "dish_drop_agent_0_max": 5, "dish_drop_agent_1_mean": 2.0, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 8, "useful_dish_drop_agent_0_mean": 2.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.2, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 6, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.1, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 1, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.8, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 2, "optimal_onion_potting_agent_1_mean": 0.6, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 2, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 2, "viable_onion_potting_agent_1_mean": 0.6, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 2, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0, "is_off_distribution_agent_0_mean": 0.0, "is_off_distribution_agent_0_min": 0, "is_off_distribution_agent_0_max": 0, "is_off_distribution_agent_1_mean": 0.0, "is_off_distribution_agent_1_min": 0, "is_off_distribution_agent_1_max": 0, "reward_shaping_factor_mean": 0.0, "reward_shaping_factor_min": 0.0, "reward_shaping_factor_max": 0.0, "potential_shaping_factor_mean": 0.0, "potential_shaping_factor_min": 0.0, "potential_shaping_factor_max": 0.0, "bc_factor_mean": 0.0, "bc_factor_min": 0.0, "bc_factor_max": 0.0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.08888054678424052, "mean_inference_ms": 0.8410948267748722, "mean_action_processing_ms": 0.05815628163122909, "mean_env_wait_ms": 0.6284395032440206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 4000, "agent_timesteps_total": 8000, "timers": {"sample_time_ms": 666.006, "sample_throughput": 1201.19, "learn_time_ms": 145.992, "learn_throughput": 5479.738, "update_time_ms": 2.204}, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": -1.375097781419754e-05, "policy_loss": -1.3892538845539093e-05, "vf_loss": 0.0014387764967978, "vf_explained_var": -1.0, "kl": 1.8483079955444737e-08, "entropy": 1.7910616397857666, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 4000, "num_agent_steps_sampled": 8000, "num_steps_trained": 4000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 10, "training_iteration": 5, "experiment_id": "3acdca3ad0124e18ad2942cc85603152", "date": "2021-06-10_12-08-20", "timestamp": 1623352100, "time_this_iter_s": 0.766136884689331, "time_total_s": 4.457353353500366, "pid": 92057, "hostname": "Nathans-MacBook-Pro.local", "node_ip": "192.168.1.27", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "train_batch_size": 800, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_schedule": [[0, 1.0], [3000000.0, 0]], "potential_shaping_schedule": [[0, 1.0], [Infinity, 0]], "use_potential_shaping": false, "use_reward_shaping": false, "bc_schedule": [[0, 0], [Infinity, 0]], "potential_constants": {"min_coeff": 0.7, "max_delivery_steps": 10, "max_pickup_steps": 20, "pot_onion_steps": 10, "pot_tomato_steps": 10, "useful_counter_coeff": 2, "non_useful_counter_coeff": 0}, "bc_opt": false, "ficticious_self_play": false}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}}}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "log_level": "ERROR", "callbacks": "<function gen_trainer_from_params.<locals>.<lambda> at 0x7ff7c4756680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 10, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7ff7c445da70>", "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ppo": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(0.0, inf, (5, 4, 26), float32)", "Discrete(6)", {"model": {"custom_model_config": {"use_lstm": false, "vf_share_layers": true, "NUM_HIDDEN_LAYERS": 3, "SIZE_HIDDEN_LAYERS": 64, "NUM_FILTERS": 25, "NUM_CONV_LAYERS": 3, "CELL_SIZE": 256, "D2RL": false}, "custom_model": "MyPPOModel"}}]}, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7ff7c4756ef0>", "policies_to_train": ["ppo"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.98, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "shuffle_sequences": true, "num_sgd_iter": 1, "lr_schedule": null, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.0], [300000.0, 0.0]], "clip_param": 0.05, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4.457353353500366, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.1, "ram_util_percent": 62.6}}
